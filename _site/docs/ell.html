<h1 id="building-ell-for-macos">Building ELL for macOS</h1>

<p>Out of Microsoft Research and in early preview, is the Embedded Learning Library, a toolkit for deploying pre-made, small models to a resource contrained system, like a Raspberry Pi 3.  The models are designed to run without any connection to the cloud resulting in a truly disconnected device use case.</p>

<h2 id="walkthrough">Walkthrough</h2>

<p>My macOS specs:</p>

<p><img src="img/mac-specs-20180528.png" alt="mac specs" /></p>

<p>As the writing of this article, release 2.3.0 of the Embedded Learning Library (ELL) was successfully built.</p>

<p>On macOS, to build, follow this tutorial:  https://github.com/Microsoft/ELL/blob/master/INSTALL-Mac.md, except for the <code class="highlighter-rouge">llvm</code> install (see below) and ensure that you are using the full path to llvm when using <code class="highlighter-rouge">cmake</code>, as in:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake -DLLVM_DIR=/usr/local/opt/llvm/lib/cmake/llvm ..
</code></pre></div></div>

<p>The following is based on reference (1) (see <a href="#references">References</a>).</p>

<p>Get llvm 3.9.x (need 3.9 to work with ELL):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install --with-toolchain llvm
</code></pre></div></div>

<p>Get a list of local version and the active version:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew search llvm
</code></pre></div></div>

<p>Optional (in case you donâ€™t get llvm 3.9.x):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew update
brew upgrade
</code></pre></div></div>

<p>Find the binaries:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(brew --prefix llvm)/bin
</code></pre></div></div>

<p>Added to <code class="highlighter-rouge">~/.bashrc</code> file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># For building ELL</span>
<span class="nb">export </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">"-L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib"</span>
<span class="nb">export </span><span class="nv">CPPFLAGS</span><span class="o">=</span><span class="s2">"-I/usr/local/opt/llvm/include -I/usr/local/opt/llvm/include/c++/v1/"</span>
<span class="nb">export </span><span class="nv">CC</span><span class="o">=</span>/usr/local/opt/llvm/bin/clang
<span class="nb">export </span><span class="nv">CXX</span><span class="o">=</span>/usr/local/opt/llvm/bin/clang++
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source ~/.bashrc
</code></pre></div></div>

<p>To build the python bindings ensure you run <code class="highlighter-rouge">make</code> with the right flag:  <code class="highlighter-rouge">make _ELL_python</code></p>

<h2 id="my-troubleshooting">My Troubleshooting</h2>

<ul>
  <li>Getting the right C and C++ compiler specified - these must be the llvm versions for ELL to build.</li>
  <li>If something goes awry and the build continuously fails, the last resort is to delete the whole <code class="highlighter-rouge">build</code> folder and then recreate it and follow the rest of the instructions.</li>
  <li>Make sure using the brew installed packages.  These should be the ones in the <code class="highlighter-rouge">/usr/local/opt</code>.</li>
  <li>Follow tutorial instructions for using the right LLVM module at their <a href="https://github.com/Microsoft/ELL/blob/master/INSTALL-Mac.md#troubleshooting">troubleshooting</a></li>
</ul>

<h2 id="references">References</h2>

<ol>
  <li>https://embeddedartistry.com/blog/2017/2/20/installing-clangllvm-on-osx</li>
</ol>

