<p><strong>tl;dr</strong>:  Notes on building CNTK (Cognitive Toolkit) on macOS.</p>

<p><strong>Posted:</strong>  2018-05-16</p>

<p>Following:  https://docs.microsoft.com/en-us/cognitive-toolkit/Setup-CNTK-on-Linux with some modifications.</p>

<p>Ensure XCode is installed</p>

<p>Proceed with steps in article with the following modifications.</p>

<h2 id="my-system-by-the-way">My System (by the way)</h2>

<p>&lt;img src=img/my_sys.png width=50%&gt;</p>

<p><code class="highlighter-rouge">g++ --version</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Apple LLVM version 9.0.0 (clang-900.0.39.2)
    Target: x86_64-apple-darwin17.3.0
    Thread model: posix
    InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
</code></pre></div></div>

<h2 id="mkl">MKL</h2>

<p>For https://docs.microsoft.com/en-us/cognitive-toolkit/Setup-CNTK-on-Linux#mkl (MKL install) use the following:</p>

<p>Create the directory for MKL:  <code class="highlighter-rouge">sudo mkdir /usr/local/mklmil</code></p>

<p>Create a file <code class="highlighter-rouge">build_mklml.sh</code> and add the following to it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>wget https://github.com/intel/mkl-dnn/releases/download/v0.14/mklml_mac_2018.0.3.20180406.tgz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">sudo tar</span> <span class="nt">-xzf</span> mklml_mac_2018.0.3.20180406.tgz <span class="nt">-C</span> /usr/local/mklml <span class="o">&amp;&amp;</span> <span class="se">\</span>
wget <span class="nt">--no-verbose</span> <span class="nt">-O</span> - https://github.com/01org/mkl-dnn/archive/v0.12.tar.gz | <span class="nb">tar</span> <span class="nt">-xzf</span> - <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>mkl-dnn-0.12 <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">ln</span> <span class="nt">-s</span> /usr/local external <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> build <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>build <span class="o">&amp;&amp;</span> <span class="se">\</span>
cmake .. <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="nb">install</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd</span> ../.. <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">rm</span> <span class="nt">-rf</span> mkl-dnn-0.12
</code></pre></div></div>

<p>Modify <code class="highlighter-rouge">build_mklml.sh</code> to be executible (<code class="highlighter-rouge">chmod +x build_mklml.sh</code>) and run (<code class="highlighter-rouge">./build_mklml.sh</code>).</p>

<h2 id="openmpi">OpenMPI</h2>

<p>This is not a modification, just a code snippet for a bash script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://www.open-mpi.org/software/ompi/v1.10/downloads/openmpi-1.10.3.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">tar</span> <span class="nt">-xzvf</span> ./openmpi-1.10.3.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>openmpi-1.10.3 <span class="o">&amp;&amp;</span> <span class="se">\</span>
./configure <span class="nt">--prefix</span><span class="o">=</span>/usr/local/mpi <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="nt">-j</span> all <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<h2 id="protobuf">Protobuf</h2>

<p>Skipped the <code class="highlighter-rouge">apt-get</code> commands.</p>

<p>This is not a modification, just a code snippet for a bash script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/google/protobuf/archive/v3.1.0.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">tar</span> <span class="nt">-xzf</span> v3.1.0.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>protobuf-3.1.0 <span class="o">&amp;&amp;</span> <span class="se">\</span>
./autogen.sh <span class="o">&amp;&amp;</span> <span class="se">\</span>
./configure <span class="nv">CFLAGS</span><span class="o">=</span><span class="nt">-fPIC</span> <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="nt">-fPIC</span> <span class="nt">--disable-shared</span> <span class="nt">--prefix</span><span class="o">=</span>/usr/local/protobuf-3.1.0 <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="nt">-j</span> <span class="k">$(</span><span class="nb">nproc</span><span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<h2 id="zlib">ZLIB</h2>

<p>I did not need to <code class="highlighter-rouge">apt-get</code> or download/install this library as it was already installed, but if not on your system and the correct version, follow the instructions in the article.</p>

<h2 id="libzip">LIBZIP</h2>

<p>This is not a modification, just a code snippet for a bash script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget http://nih.at/libzip/libzip-1.1.2.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">tar</span> <span class="nt">-xzvf</span> ./libzip-1.1.2.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>libzip-1.1.2 <span class="o">&amp;&amp;</span> <span class="se">\</span>
./configure <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="nt">-j</span> all <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<h2 id="boost">Boost</h2>

<p>Skipped the <code class="highlighter-rouge">apt-get</code> commands.</p>

<p>Ran as a bash script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>It can take some time.</p>
